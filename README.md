# GitHub PR Reaction Scraper (Python Edition)

This repository contains a Python script (`fetch_reactions.py`) designed to collect and score emoji reactions from GitHub Pull Requests. The primary goal is to gather subjective feedback on code reviews, with a special focus on reviews generated by GitHub Copilot.

The script aggregates reactions based on a point system, allowing for quantitative analysis of qualitative feedback.

## Features

-   **Robust and Maintainable**: Written in Python for better error handling and easier maintenance.
-   **Multi-Repository Support**: Scans one or more specified repositories.
-   **Date Range Filtering**: Collects data from Pull Requests created within a defined period.
-   **Comprehensive Comment Collection**: Gathers reactions from issue comments, review comments, and review summaries.
-   **Flexible Output**: Can output data as a standard CSV or display a formatted summary directly in the terminal.
-   **Analysis from File**: Can generate a summary from a previously saved CSV file, avoiding repeated API calls.

## Prerequisites

-   **Python 3.6+**
-   [**GitHub CLI (`gh`)**](https://cli.github.com/): For interacting with the GitHub API.

## Setup

1.  **Install GitHub CLI:**
    -   On macOS (using Homebrew): `brew install gh`
    -   On Ubuntu: `sudo apt update && sudo apt install gh -y`

2.  **Authenticate with GitHub:**
    Log in to your GitHub account. The script uses your `gh` credentials to access the API.
    ```bash
    gh auth login
    ```

## How to Use

The script is controlled via command-line arguments.

### Basic Commands

-   **Collect data and output as CSV:**
    ```bash
    python3 fetch_reactions.py --repos owner/repo1 owner/repo2 > reactions.csv
    ```
    The `reactions.csv` file will look like this:
    ```csv
    date,repository,points
    2025-06-25,owner/repo1,3
    2025-06-26,owner/repo1,1
    2025-06-26,owner/repo2,-1
    ```

-   **Display a summary directly:**
    ```bash
    python3 fetch_reactions.py --repos owner/repo1 --summary
    ```
    The output will look like this:
    ```
    --- Daily Summary ---
    Date          | Reactions | Total Points | Average Points  
    ------------------------------------------------------------
    2025-06-25    | 1         | 3            | 3.00            
    2025-06-26    | 2         | 0            | 0.00            

    --- Weekly Summary ---
    Week          | Reactions | Total Points | Average Points  
    ------------------------------------------------------------
    2025-26       | 3         | 3            | 1.00            
    ```

-   **Generate a summary from an existing file:**
    ```bash
    python3 fetch_reactions.py --file reactions.csv
    ```
    The output will be the same summary format as above.

### All Options

| Argument          | Short | Description                                                                   |
| ----------------- | ----- | ----------------------------------------------------------------------------- |
| `--repos REPOS`   |       | One or more repositories to scan (e.g., `owner/repo1 owner/repo2`).            |
| `--start-date`    |       | Start of the date range (YYYY-MM-DD). Defaults to 60 days ago.                |
| `--end-date`      |       | End of the date range (YYYY-MM-DD). Defaults to today.                        |
| `--all-users`     | `-a`  | Fetch reactions for all users, not just the Copilot bot.                      |
| `--summary`       | `-s`  | Show a formatted summary in the terminal instead of CSV output.               |
| `--file FILE`     | `-f`  | Generate a summary from a specified CSV file instead of fetching new data.    |

### Example: Get a summary of all user reactions for the last month

```bash
python3 fetch_reactions.py --repos microsoft/vscode --summary --all-users --start-date 2025-05-26
```

### Emoji Scoring System

The script uses the following point system, which can be customized in the `POINTS_MAP` dictionary at the top of the script.

| Emoji        | Points |
| :----------- | :----: |
| üëç `+1`      |   +3   |
| üéâ `hooray`   |   +2   |
| ‚ù§Ô∏è `heart`     |   +2   |
| üöÄ `rocket`    |   +1   |
| üòÑ `laugh`    |   +1   |
| ü§î `confused` |   -1   |
| üëé `-1`      |   -2   |
| *Other*      |    0   |

## License

This project is licensed under the MIT License.