# GitHub PR Reaction Scraper (Python Edition)

This repository contains a Python script (`fetch_reactions.py`) designed to collect and score emoji reactions from GitHub Pull Requests. The primary goal is to gather subjective feedback on code reviews, with a special focus on reviews generated by GitHub Copilot.

The script aggregates reactions based on a point system, allowing for quantitative analysis of qualitative feedback.

## Features

-   **Granular Analysis**: Collects reactions on a per-user basis.
-   **Comprehensive Summaries**: Displays summaries broken down by day, week, and user.
-   **Robust and Maintainable**: Written in Python for better error handling and easier maintenance.
-   **Multi-Repository Support**: Scans one or more specified repositories.
-   **Date Range Filtering**: Collects data from Pull Requests created within a defined period.
-   **Flexible Output**: Can output data as a standard CSV or display a formatted summary directly in the terminal.
-   **Analysis from File**: Can generate a summary from a previously saved CSV file, avoiding repeated API calls.

## Prerequisites

-   **Python 3.6+**
-   [**GitHub CLI (`gh`)**](https://cli.github.com/): For interacting with the GitHub API.

## Setup

1.  **Install GitHub CLI:**
    -   On macOS (using Homebrew): `brew install gh`
    -   On Ubuntu: `sudo apt update && sudo apt install gh -y`

2.  **Authenticate with GitHub:**
    Log in to your GitHub account. The script uses your `gh` credentials to access the API.
    ```bash
    gh auth login
    ```

## How to Use

The script is controlled via command-line arguments.

### CSV Output

Collect data and save it to a CSV file. The output now includes the username of the person who reacted.

```bash
python3 fetch_reactions.py --repos owner/repo1 --all-users > reactions.csv
```

The `reactions.csv` file will look like this:
```csv
date,repository,user,points
2025-06-25,owner/repo1,some-user,3
2025-06-26,owner/repo1,another-user,1
2025-06-26,owner/repo2,dev-1,-1
```

### Summary Output

Display a formatted summary directly in the terminal. The summary now includes a **Per-User** breakdown.

```bash
python3 fetch_reactions.py --repos owner/repo1 --summary --all-users
```

The output will look like this:
```
--- Daily Summary ---
Date          | Reactions | Total Points | Average Points  
------------------------------------------------------------
2025-06-25    | 1         | 3            | 3.00            
2025-06-26    | 2         | 0            | 0.00            

--- Weekly Summary ---
Week          | Reactions | Total Points | Average Points  
------------------------------------------------------------
2025-26       | 3         | 3            | 1.00            

--- Per-User Summary ---
User                 | Reactions | Total Points | Average Points  
-------------------------------------------------------------------
some-user            | 1         | 3            | 3.00            
another-user         | 1         | 1            | 1.00            
dev-1                | 1         | -1           | -1.00           
```

### Generate Summary from File

Generate the same three-part summary from a previously created CSV file.

```bash
python3 fetch_reactions.py --file reactions.csv
```

### All Options

| Argument          | Short | Description                                                                   |
| ----------------- | ----- | ----------------------------------------------------------------------------- |
| `--repos REPOS`   |       | One or more repositories to scan (e.g., `owner/repo1 owner/repo2`).            |
| `--start-date`    |       | Start of the date range (YYYY-MM-DD). Defaults to 60 days ago.                |
| `--end-date`      |       | End of the date range (YYYY-MM-DD). Defaults to today.                        |
| `--all-users`     | `-a`  | Fetch reactions for all users, not just the Copilot bot.                      |
| `--summary`       | `-s`  | Show a formatted summary in the terminal instead of CSV output.               |
| `--file FILE`     | `-f`  | Generate a summary from a specified CSV file instead of fetching new data.    |

## Emoji Scoring System

The script uses the following point system, which can be customized in the `POINTS_MAP` dictionary at the top of the script.

| Emoji        | Points |
| :----------- | :----: |
| üëç `+1`      |   +3   |
| üéâ `hooray`   |   +2   |
| ‚ù§Ô∏è `heart`     |   +2   |
| üöÄ `rocket`    |   +1   |
| üòÑ `laugh`    |   +1   |
| ü§î `confused` |   -1   |
| üëé `-1`      |   -2   |
| *Other*      |    0   |

## License

This project is licensed under the MIT License.
